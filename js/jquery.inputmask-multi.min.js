/*
 * @license Multi Input Mask plugin for jquery
 * https://github.com/andr-04/inputmask-multi
 * Copyright (c) 2012-2016 Andrey Egorov
 * Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * Version: 1.1.0
 *
 * Requriements:
 * https://github.com/RobinHerbots/jquery.inputmask
 * https://github.com/private-face/jquery.bind-first
 */
!function(t){t.masksLoad=function(e){var n;return t.ajax({url:e,async:!1,dataType:"json",success:function(t){n=t}}),n},t.masksSort=function(e,n,i,a){return e.sort(function(e,r){for(var s=0,c=0;s<e[a].length&&c<r[a].length;){var l=e[a].charAt(s),o=r[a].charAt(c);if(i.test(l))if(i.test(o)){if(-1!=t.inArray(l,n)&&-1==t.inArray(o,n))return 1;if(-1==t.inArray(l,n)&&-1!=t.inArray(o,n))return-1;if(-1==t.inArray(l,n)&&-1==t.inArray(o,n)&&l!=o)return o>l?-1:1;s++,c++}else c++;else s++}for(;s<e[a].length||c<r[a].length;)if(s<e[a].length&&!i.test(e[a].charAt(s)))s++;else if(c<r[a].length&&!i.test(r[a].charAt(c)))c++;else{if(s<e[a].length)return 1;if(c<r[a].length)return-1}return 0}),e},t.fn.inputmasks=function(e,n){var i=function(t,e){if("number"!=typeof t){if(this.setSelectionRange)t=this.selectionStart,e=this.selectionEnd;else if(document.selection&&document.selection.createRange){var n=document.selection.createRange();t=0-n.duplicate().moveStart("character",-1e5),e=t+n.text.length}return{begin:t,end:e}}if(e="number"==typeof e?e:t,this.setSelectionRange)this.setSelectionRange(t,e);else if(this.createTextRange){var n=this.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",t),n.select()}},a=Object.keys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)e[e.length]=n;return e};e=t.extend(!0,{onMaskChange:t.noop},e);var r={};for(var s in e.inputmask.definitions){var c=e.inputmask.definitions[s].validator;switch(typeof c){case"string":r[s]=new RegExp(c);break;case"object":"test"in e.definitions[s].validator&&(r[s]=c);break;case"function":r[s]={test:c}}}e.inputmask.definitions[e.replace]={validator:e.match.source,cardinality:1};var l=null!=navigator.userAgent.match(/iphone/i),o=!1,u=t.extend(!0,{},Inputmask.prototype.defaults,e.inputmask).placeholder,h=t.extend(!0,{},Inputmask.prototype.defaults,e.inputmask).insertMode,d=function(t){for(var n="",i=0;i<t.length;i++){var s=t.charAt(i);if(s==u)break;e.match.test(s)&&(n+=s)}for(var c in e.list){for(var l=e.list[c][e.listKey],o=!0,h=0,d=0;h<n.length&&d<l.length;){var f=l.charAt(d),m=n.charAt(h);if(e.match.test(f)||f in r){if(!(f in r&&r[f].test(m)||m==f)){o=!1;break}h++,d++}else d++}if(o&&h==n.length){var p=-1==l.substr(d).search(e.match);l=l.replace(new RegExp([e.match.source].concat(a(r)).join("|"),"g"),e.replace);var g=-1==l.substr(d).search(e.replace);return{mask:l,obj:e.list[c],determined:p,completed:g}}}return!1},f=function(t,n,i){if(!t)return 0;for(var a=0,r=0;a<i.begin;a++)t.charAt(a)==e.replace&&r++;for(var s=0;a<i.end;a++)t.charAt(a)==e.replace&&s++;for(a=0;a<n.length&&(r>0||n.charAt(a)!=e.replace);a++)n.charAt(a)==e.replace&&r--;for(r=a;a<n.length&&s>0;a++)n.charAt(a)==e.replace&&s--;return s=a,{begin:r,end:s}},m=function(){t(this).unbind(".inputmasks")},p=function(){m.call(this),t(this).bindFirst("keypress.inputmasks",b).bindFirst("input.inputmasks",j).bindFirst("paste.inputmasks",j).bindFirst("dragdrop.inputmasks",j).bindFirst("drop.inputmasks",j).bindFirst("keydown.inputmasks",k).bindFirst("setvalue.inputmasks",A).bind("blur.inputmasks",y)},g=function(n,a){if(n&&(a||n.mask!=o.mask)){var r;a||(r=f(o.mask,n.mask,i.call(this))),a&&(this.inputmask&&this.inputmask.remove(),this.value=a),t(this).inputmask(n.mask,t.extend(!0,e.inputmask,{insertMode:h})),a||i.call(this,r.begin,r.end)}return o=n,e.onMaskChange.call(this,n.obj,n.determined),!0},v=function(e,n,i){var a=d(n);return a&&a.obj==o.obj&&a.determined==o.determined?!0:(a&&(m.call(this),i?(g.call(this,a),t(this).trigger(e)):(t(this).trigger(e),g.call(this,a)),p.call(this)),e.stopImmediatePropagation(),!1)},k=function(t){t=t||window.event;var n=t.which||t.charCode||t.keyCode;if(8==n||46==n||l&&127==n){var a=this.inputmask._valueGet(),r=i.call(this);if(r.begin==r.end||!h&&r.begin==r.end-1){var s=r.begin;do{46!=n&&s--;var c=a.charAt(s);a=a.substring(0,s)+a.substring(s+1)}while(s>0&&s<a.length&&c!=u&&!e.match.test(c))}else{var o=a.substring(0,r.begin)+a.substring(r.end);-1==o.search(e.match)&&(a=o)}return v.call(this,t,a,!1)}return 45==n&&(h=!h),!0},b=function(t){var e=this.inputmask._valueGet();t=t||window.event;var n=t.which||t.charCode||t.keyCode,a=String.fromCharCode(n);return caretPos=i.call(this),e=e.substring(0,caretPos.begin)+a+e.substring(caretPos.end),v.call(this,t,e,!0)},y=function(t){var e=d(this.inputmask._valueGet());return g.call(this,e),p.call(this),!0},A=function(t){return w.call(this),t.stopImmediatePropagation(),!0},w=function(){var t;t=this.inputmask&&this.inputmask._valueGet?this.inputmask._valueGet():this.value;for(var e=d(t);!e&&t.length>0;)t=t.substr(0,t.length-1),e=d(t);g.call(this,e,t),p.call(this)},j=function(t){var e=this;return setTimeout(function(){w.call(e)},0),t.stopImmediatePropagation(),!0};switch(n){case"isCompleted":var x=d(this[0].inputmask&&this[0].inputmask._valueGet()||this[0].value);return x&&x.completed;default:return this.each(function(){m.call(this),w.call(this)}),this}}}(jQuery);